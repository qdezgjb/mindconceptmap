# ============================================================================
# MINDPHASE ENVIRONMENT CONFIGURATION
# ============================================================================
# Copy this file to .env and configure according to your deployment needs

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
HOST=0.0.0.0
PORT=9527
DEBUG=False

# Optional: Set your public WAN IP for external access (auto-detected if not set)
# EXTERNAL_HOST=your-public-ip-address

# ============================================================================
# CORE LLM CONFIGURATION
# ============================================================================

# Qwen API (Required)
QWEN_API_KEY=sk-c135ed36bdf047d68ad83aafc5ce2190
QWEN_API_URL=https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions
QWEN_MODEL_CLASSIFICATION=qwen-turbo
QWEN_MODEL_GENERATION=qwen-max
QWEN_TEMPERATURE=0.7
QWEN_MAX_TOKENS=1000
QWEN_TIMEOUT=40

# Unified temperature for diagram generation (0.1-0.3 for JSON, 0.7-1.0 for creative)
LLM_TEMPERATURE=0.3

# Tencent Hunyuan API (Optional)
# Register at: https://cloud.tencent.com/product/hunyuan
# Note: Temperature must be ≤ 2.0
HUNYUAN_API_KEY=your-hunyuan-secretkey-here
HUNYUAN_SECRET_ID=your-hunyuan-secretid-here
HUNYUAN_API_URL=https://hunyuan.tencentcloudapi.com
HUNYUAN_MODEL=hunyuan-turbo
HUNYUAN_TEMPERATURE=1.0
HUNYUAN_MAX_TOKENS=2000

# Volcengine Doubao API (Optional)
# Register at: https://www.volcengine.com/product/doubao
# Uses OpenAI-compatible API (ARK)
ARK_API_KEY=your-ark-api-key-here
ARK_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
DOUBAO_MODEL=doubao-1-5-pro-32k-250115

# DeepSeek API (Optional)
DEEPSEEK_API_KEY=sk-9a648537412d4f3492f4899a4196cb3a

# Dashscope Rate Limiting (shared across Qwen, DeepSeek, Kimi)
# Free tier: 60 QPM, 10 concurrent | Standard: 300 QPM, 50+ concurrent
DASHSCOPE_QPM_LIMIT=1000
DASHSCOPE_CONCURRENT_LIMIT=500
DASHSCOPE_RATE_LIMITING_ENABLED=true

# Qwen Omni Realtime (Voice Agent)
QWEN_OMNI_MODEL=qwen3-omni-flash-realtime-2025-12-01
QWEN_OMNI_VOICE=Cherry
QWEN_OMNI_VAD_THRESHOLD=0.5
QWEN_OMNI_VAD_SILENCE_MS=1200
QWEN_OMNI_VAD_PREFIX_MS=300
QWEN_OMNI_SMOOTH_OUTPUT=true
QWEN_OMNI_INPUT_FORMAT=pcm16
QWEN_OMNI_OUTPUT_FORMAT=pcm24
QWEN_OMNI_TRANSCRIPTION_MODEL=gummy-realtime-v1

# ============================================================================
# UI & DISPLAY CONFIGURATION
# ============================================================================
GRAPH_LANGUAGE=zh
DEFAULT_LANGUAGE=zh
TOPIC_FONT_SIZE=18
CHAR_FONT_SIZE=14
WATERMARK_TEXT=MindGraph

# ============================================================================
# LOGGING & DEBUGGING
# ============================================================================
LOG_LEVEL=INFO
VERBOSE_LOGGING=False

# ============================================================================
# FEATURE FLAGS
# ============================================================================
FEATURE_LEARNING_MODE=False
FEATURE_THINKGUIDE=False
FEATURE_MINDMATE=False
FEATURE_VOICE_AGENT=False
FEATURE_DRAG_AND_DROP=False
FEATURE_TAB_MODE=False

# ============================================================================
# AI ASSISTANT CONFIGURATION
# ============================================================================
DIFY_API_KEY=your_dify_api_key_here
DIFY_API_URL=http://101.42.231.179/v1
DIFY_TIMEOUT=30
AI_ASSISTANT_NAME=教学设计

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DATABASE_URL=sqlite:///./data/mindgraph.db

# ============================================================================
# DATABASE BACKUP CONFIGURATION
# ============================================================================
BACKUP_ENABLED=true
BACKUP_HOUR=3
BACKUP_RETENTION_COUNT=2
BACKUP_DIR=backup

# ============================================================================
# TENCENT CLOUD OBJECT STORAGE (COS) CONFIGURATION (Optional)
# ============================================================================
# Register at: https://console.cloud.tencent.com/cos5
# Uses same credentials as SMS (TENCENT_SMS_SECRET_ID, TENCENT_SMS_SECRET_KEY)
COS_BACKUP_ENABLED=false
COS_BUCKET=your-bucket-name-appid
COS_REGION=ap-beijing
# Use different prefixes for different environments (e.g., backups/mindgraph-Master)
COS_KEY_PREFIX=backups/mindgraph-CHANGE

# ============================================================================
# AUTHENTICATION & SECURITY CONFIGURATION
# ============================================================================
# Generate secure key: python -c "import secrets; print(secrets.token_urlsafe(48))"
JWT_SECRET_KEY=QwWZfgwi-ct3rBdWyhoXa7S5mzHuC6yaGgmzGC_-1qSMl4H-879Ng4jZIq1cBSR7
JWT_EXPIRY_HOURS=24

# Auth modes: standard, enterprise, demo, bayi
AUTH_MODE=standard
# Admin phone numbers (comma-separated). After registering with invitation code, add your phone here and restart server
# Example: ADMIN_PHONES=13812345678,13987654321
ADMIN_PHONES=

# Enterprise Mode (only if AUTH_MODE=enterprise)
ENTERPRISE_DEFAULT_ORG_CODE=DEMO-001
ENTERPRISE_DEFAULT_USER_PHONE=enterprise@system.com

# Demo Mode (only if AUTH_MODE=demo)
DEMO_PASSKEY=888888
ADMIN_DEMO_PASSKEY=999999

# Bayi Mode (only if AUTH_MODE=bayi)
BAYI_DECRYPTION_KEY=v8IT7XujLPsM7FYuDPRhPtZk
BAYI_DEFAULT_ORG_CODE=BAYI-001
BAYI_CLOCK_SKEW_TOLERANCE=10
BAYI_IP_WHITELIST=

# Invitation Codes: Format AAAA-XXXXX (4 uppercase letters, dash, 5 uppercase letters/digits)
# Internal format: ORG_CODE:INVITATION_CODE:EXPIRY_DATE (expiry optional, defaults to "never")
# Users only need the invitation code (e.g., DEMO-A1B2C) to register
INVITATION_CODES=DEMO-001:DEMO-A1B2C:never

# ============================================================================
# TENCENT CLOUD SMS CONFIGURATION (Optional)
# ============================================================================
# Register at: https://console.cloud.tencent.com/smsv2
TENCENT_SMS_SECRET_ID=your-tencent-secret-id-here
TENCENT_SMS_SECRET_KEY=your-tencent-secret-key-here
TENCENT_SMS_SDK_APP_ID=1400000000
TENCENT_SMS_SIGN_NAME=MindGraph
TENCENT_SMS_REGION=ap-guangzhou
TENCENT_SMS_TEMPLATE_REGISTER=1234567
TENCENT_SMS_TEMPLATE_LOGIN=1234568
TENCENT_SMS_TEMPLATE_RESET_PASSWORD=1234569

# SMS Rate Limiting
SMS_CODE_EXPIRY_MINUTES=5
SMS_RESEND_INTERVAL_SECONDS=60
SMS_MAX_ATTEMPTS_PER_PHONE=5
SMS_MAX_ATTEMPTS_WINDOW_HOURS=1
SMS_MAX_CONCURRENT_REQUESTS=10
SMS_QPM_LIMIT=100
SMS_RATE_LIMITING_ENABLED=true

# ============================================================================
# REVERSE PROXY CONFIGURATION
# ============================================================================
# For Nginx Proxy Manager, add in Advanced > Custom Nginx Configuration:
# proxy_set_header X-Real-IP $remote_addr;
# proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
# proxy_set_header X-Forwarded-Proto $scheme;
# TRUSTED_PROXY_IPS=10.0.0.1,192.168.1.100

# ============================================================================
# EXTERNAL SERVICES CONFIGURATION
# ============================================================================
# Resend API: https://resend.com (Free tier: 100 emails/day)
RESEND_API_KEY=re_your_resend_api_key_here
RESEND_FROM_EMAIL=MindGraph <feedback@mindspringedu.cn>
WECHAT_QR_IMAGE=
